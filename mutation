

#序列转换成.fasta，作为参考基因组
echo ">sequence_name" > mutation.fasta
cat mutation.txt >> mutation.fasta #原始纯序列文件

比对
bowtie2-build /DATA2/syh/rawdata/mutation.fasta /DATA2/syh/reference/mutation_index

nohup bowtie2 -x /DATA2/syh/reference/mutation_index \
        -1 /DATA2/syh/rawdata/m5-library-1/m5-library-1_R1.fq.gz \
        -2 /DATA2/syh/rawdata/m5-library-1/m5-library-1_R2.fq.gz \
        -S /DATA2/syh/output/m5-library-1/m5-library-1_aligned.sam \
        -p 16 &

nohup samtools view -bS /DATA2/syh/output/m5-library-1/m5-library-1_aligned.sam > /DATA2/syh/output/m5-library-1/m5-library-1_aligned.bam &
#排序
samtools sort /DATA2/syh/output/m5-library-1/m5-library-1_aligned.bam -o /DATA2/syh/output/m5-library-1/m5-library-1_sorted.bam
#索引
samtools index /DATA2/syh/output/m5-library-1/m5-library-1_sorted.bam
#比对统计信息
samtools flagstat /DATA2/syh/output/m5-library-1/m5-library-1_sorted.bam

尝试1
#检测突变 生成vcf文件
nohup samtools mpileup -f /DATA2/syh/rawdata/mutation.fasta /DATA2/syh/output/m5-library-1/m5-library-1_sorted.bam -v -o /DATA2/syh/output/m5-library-1/temp.vcf &

bcftools view /DATA2/syh/output/m5-library-1/temp.vcf

#java
conda install -c conda-forge openjdk=21

尝试2
#用bedtools标记感兴趣区域
vi regions.bed
seq1    81    120

bedtools getfasta -fi /DATA2/syh/rawdata/mutation.fasta -bed /DATA2/syh/output/m5-library-1/regions.bed \
-ibam /DATA2/syh/output/m5-library-1/m5-library-1_sorted.bam \
> m5-library-1_sorted.fasta 





#使用snpEff注释变异
nohup java -jar /DATA2/syh/software/SnpEff/snpEff/snpEff.jar ann /DATA2/syh/rawdata/mutation.fasta \
/DATA2/syh/output/m5-library-1/temp.vcf > /DATA2/syh/output/m5-library-1/m5-library-1_annotated_variants.vcf &

nano /DATA2/syh/software/SnpEff/snpEff/snpEff.config



nohup java -jar /DATA2/syh/software/SnpEff/snpEff/snpEff.jar ann -v /DATA2/syh/rawdata/mutation.fasta \
/DATA2/syh/output/m5-library-1/temp.vcf > /DATA2/syh/output/m5-library-1/m5-library-1_annotated_variants.vcf \
2> /DATA2/syh/output/m5-library-1/m5-library-1_error.log &


